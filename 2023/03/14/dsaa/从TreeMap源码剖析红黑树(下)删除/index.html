<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/articles/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/articles/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/articles/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/articles/images/logo.svg" color="#222">

<link rel="stylesheet" href="/articles/css/main.css">


<link rel="stylesheet" href="/articles/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"tubetrue01.github.io","root":"/articles/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="引言 本篇文章作为红黑树的最后一篇文章，介绍红黑树的删除操作，也是最难的一部分。我们话不多说，直接进入正题。  2-3-4 树的删除 我们知道红黑树的本质是 2-3-4 树，所以在介绍红黑树的删除操作前，需要先了解 2-3-4 树的删除操作。    上图是一棵 2-3-4 树，其中包含了 2 节点、3 节点、4 节点。接下来我们逐个分析下对每种节点的删除。 三节点的删除如图 1 所示，其中（1、2">
<meta property="og:type" content="article">
<meta property="og:title" content="从 TreeMap 源码剖析红黑树（下）删除">
<meta property="og:url" content="https://tubetrue01.github.io/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/">
<meta property="og:site_name" content="Tubetrue01">
<meta property="og:description" content="引言 本篇文章作为红黑树的最后一篇文章，介绍红黑树的删除操作，也是最难的一部分。我们话不多说，直接进入正题。  2-3-4 树的删除 我们知道红黑树的本质是 2-3-4 树，所以在介绍红黑树的删除操作前，需要先了解 2-3-4 树的删除操作。    上图是一棵 2-3-4 树，其中包含了 2 节点、3 节点、4 节点。接下来我们逐个分析下对每种节点的删除。 三节点的删除如图 1 所示，其中（1、2">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/01.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/02.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/03.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/04.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/05.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/06.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/07.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/08.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/09.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/10.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/11.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/12.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/13.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/14.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/15.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/16.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/17.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/18.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/19.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/20.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/21.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/22.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/23.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/24.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/25.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/26.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/27.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/28.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/29.jpg">
<meta property="og:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/30.jpg">
<meta property="article:published_time" content="2023-03-14T03:17:17.000Z">
<meta property="article:modified_time" content="2023-07-20T07:40:14.000Z">
<meta property="article:author" content="Tubetrue01">
<meta property="article:tag" content="数据结构与算法">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tubetrue01.github.io/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/01.jpg">

<link rel="canonical" href="https://tubetrue01.github.io/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>从 TreeMap 源码剖析红黑树（下）删除 | Tubetrue01</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/articles/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Tubetrue01</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/articles/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/articles/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/articles/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://www.jianshu.com/u/46af180aa88f" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tubetrue01.github.io/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/articles/img/head.PNG">
      <meta itemprop="name" content="Tubetrue01">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tubetrue01">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          从 TreeMap 源码剖析红黑树（下）删除
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-03-14 11:17:17" itemprop="dateCreated datePublished" datetime="2023-03-14T11:17:17+08:00">2023-03-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-07-20 15:40:14" itemprop="dateModified" datetime="2023-07-20T15:40:14+08:00">2023-07-20</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><blockquote>
<p>本篇文章作为红黑树的最后一篇文章，介绍红黑树的删除操作，也是最难的一部分。我们话不多说，直接进入正题。</p>
</blockquote>
<h1 id="2-3-4-树的删除"><a href="#2-3-4-树的删除" class="headerlink" title="2-3-4 树的删除"></a>2-3-4 树的删除</h1><blockquote>
<p>我们知道红黑树的本质是 2-3-4 树，所以在介绍红黑树的删除操作前，需要先了解 2-3-4 树的删除操作。</p>
</blockquote>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/01.jpg" class="" width="400">

<p>上图是一棵 2-3-4 树，其中包含了 2 节点、3 节点、4 节点。接下来我们逐个分析下对每种节点的删除。</p>
<h2 id="三节点的删除"><a href="#三节点的删除" class="headerlink" title="三节点的删除"></a>三节点的删除</h2><p>如图 1 所示，其中（1、2），（8、9），（7、10）为三节点。但是对于它们的删除其实是不同的。首先（1、2）、（8、9）作为叶子节点，我们可以删除任意一个元素而不破坏树的平衡。</p>
<p>但是对于（7、10）而言，对于 7、10 任意元素的删除都会使其变成二节点，那么此时树的平衡被打破，就需要进行调整，如图所示：</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/02.jpg" class="" width="400">

<p>当 7 被删除时，树的平衡被破坏，此时必须要找到一个可以替换它的节点。所以沿着它的右子树寻找，找到 8 之后，变把 8 的值替换掉被删的 7。然后删掉 8，此时树又恢复平衡了。</p>
<p>为什么不是用 6 替换 7 而是 8 呢？原因很简单，因为 6 是一个二节点，而（8、9）是一个三节点。用 8 替换 7 的成本是最低的。也就是说它会优先选择非二节点的子节点中的元素来替换自己。不信？我们看下图：</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/03.jpg" class="" width="400">

<p>我们删除 4，在分析 4 的两个子节点时发现 3 是二节点，5 是四节点，那不用说还是选择 5 替换自己吧。然后在把 5 替换成自身之后，把它删了。</p>
<p>但是，那如果子节点都是二节点的情况呢？我们看下图：</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/04.jpg" class="" width="400">

<p>我们继续删除元素 8。此时 8 的两个子节点都是单节点。如果此时删除 8 时，它会发现 8 的两个子节点都是单节点，那就把 6、8、9 合并成，然后删除 8 。其实也就是把 8 的两个子节点进行合并。</p>
<h2 id="四节点删除"><a href="#四节点删除" class="headerlink" title="四节点删除"></a>四节点删除</h2><blockquote>
<p>三节点分析完了，我们继续分析四节点的删除，当然作为叶子节点的删除情况就不再赘述了，因为不涉及平衡问题，直接删就对了。</p>
</blockquote>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/05.jpg" class="" width="400">

<p>删除 2 时，会对 2 的两个子树进行分析，如果都是单子节点，那么就会将 2 跟它的两个子节点合并，再删除 2。</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/06.jpg" class="" width="400">

<p>对于 4 的删除与 2 类似，就不再赘述。</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/07.jpg" class="" width="400">

<p>对于 6 的删除其实原理都是一样的，会从它的子节点中进行选择，如果是三、四节点那么就用子替换自己，如果是二节点，那么就会将两个子节点进行合并。</p>
<h2 id="二节点删除"><a href="#二节点删除" class="headerlink" title="二节点删除"></a>二节点删除</h2><blockquote>
<p>其实理解了三节点、四节点的删除之后，二节点的删除也大同小异，但我觉得还是再举一个不同的例子介绍一下吧。</p>
</blockquote>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/08.jpg" class="" width="400">

<p>2 作为二节点，没错，它就是我们本次的删除对象。分析了一下，2 有两个单子节点，运用我们之前学过的知识，1、2、3 合并，然后删除 2，于是就得到了下面的结果：</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/09.jpg" class="" width="400">

<p>2 已经顺利删除了，但是看这棵树怎么感觉这么别扭？1、3 组成的三节点是 4 的左节点与 6 平级了，但是 6 还有下一级。好像出错翻车了。。。</p>
<p>我们回想一下三节点、四节点，之所以行得通是因为它们并不是孤单一人。但二节点删除了就真的没了。所以就不能直接删除，那么到底怎么删除我们看下图：</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/10.jpg" class="" width="400">

<p>节点 2 会向上分析它的父跟兄弟节点，发现可以组合，那么 2、4、6 会组合成四节点。至此你会发现，2 不再是孤单一人，就可以运用之前的知识，对 2 的两个子进行合并，然后删除 2。</p>
<p>当然也会遇到无法合并的场景，如下图：</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/11.jpg" class="" width="400">

<p>由于 6、8 是三节点，所以 2、4 无法跟 6、8 再组合了。那此时如何处理呢？显然自己的孩子是帮不了自己了，那么只能向自己的老父亲求助了，我们看下图：</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/12.jpg" class="" width="400">

<p>此时 4 会下来跟 2 合并，但是 4 的位置不能空着，所以作为 4 的右孩子 6 就会顶替 4 的位置。此时 2 跟 4 合并之后，就跟之前的场景一样了。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><blockquote>
<p>2-3-4 树的删除就全部介绍完了，为什么花大篇幅的介绍 2-3-4 树就是要想弄懂红黑树就一定要先搞懂 2-3-4 树。所以有了以上的基础，我们再来看红黑树就简单多了。</p>
</blockquote>
<h1 id="红黑树的删除"><a href="#红黑树的删除" class="headerlink" title="红黑树的删除"></a>红黑树的删除</h1><blockquote>
<p>终于开始红黑树了，我想你一定等不及了。在开始之前，还是先啰嗦一句，对于红黑树的删除操作，一定都是发生在 2-3-4 树的叶子节点上的，从上文的 2-3-4 树就可以得知。</p>
</blockquote>
<h2 id="删除方式"><a href="#删除方式" class="headerlink" title="删除方式"></a>删除方式</h2><p>红黑树的删除需要记住的是并不会真正的将当前节点删除掉，而是查找对应的子节点，利用子节点的值替换删除节点的值，然后将子节点删除掉。以此达提高删除的效率，降低删除成本。</p>
<p>从 2-3-4 树的删除中，我们可以得知，在删除目标节点之前，会查找可以替换自己的子子节点。但是，如果同时存在两个节点时，应该选择哪个呢？如果选择左节点，我们称为前驱删除，如果选择后继节点，我们称为后继删除。<strong>TreeMap</strong> 采用了后继的删除方式，网站<a target="_blank" rel="noopener" href="https://www.cs.usfca.edu/~galles/visualization/Algorithms.html">【Data Structure Visualizations】</a> 则是采用的前驱删除。</p>
<h3 id="前驱删除"><a href="#前驱删除" class="headerlink" title="前驱删除"></a>前驱删除</h3><blockquote>
<p>所谓前驱删除，就是查找小于当前值的最大值。</p>
</blockquote>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/13.jpg" class="" width="300">

<p>如图所示，如果删除元素 5，采用前驱删除法，那么从 5 的左节点开始，一直向右子节点查询，直到元素 4。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询 t 节点的前驱节点，也就是找到比 t 小的最大值</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *       5 (t)       5 (t)         5 (t)</span></span><br><span class="line"><span class="comment"> *      / \         / \           / \</span></span><br><span class="line"><span class="comment"> *     3   8  -&gt;  (3)  8   -&gt;    3   8</span></span><br><span class="line"><span class="comment"> *    / \         / \           / \</span></span><br><span class="line"><span class="comment"> *   1   4       1   4         1  (4)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> &lt;K,V&gt; <span class="function">Entry&lt;K,V&gt; <span class="title">predecessor</span><span class="params">(Entry&lt;K,V&gt; t)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (t == <span class="keyword">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (t.left != <span class="keyword">null</span>)&#123;</span><br><span class="line">        <span class="comment">// 从左节点开始找</span></span><br><span class="line">        Entry&lt;K, V&gt; l = t.left;</span><br><span class="line">        <span class="keyword">while</span>(l.right != <span class="keyword">null</span>)&#123;</span><br><span class="line">            l = l.right;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> l;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         *  这里是另外一种特殊的场景，也就是说，t 没有左子树那就需要顺着 t 的父向上找</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         *             5            (p) 5       (ch) 5     p = null</span></span><br><span class="line"><span class="comment">         *            / \              / \          / \</span></span><br><span class="line"><span class="comment">         *       (p) 3   8   -&gt;  (ch) 3   8   -&gt;   3   8</span></span><br><span class="line"><span class="comment">         *          / \              / \          / \</span></span><br><span class="line"><span class="comment">         *  (t,ch) 2   4        (t) 2   4    (t) 2   4</span></span><br><span class="line"><span class="comment">         * ===========================================</span></span><br><span class="line"><span class="comment">         *            5                5</span></span><br><span class="line"><span class="comment">         *           / \              / \</span></span><br><span class="line"><span class="comment">         *      (p) 3   8   -&gt;      (3)  8</span></span><br><span class="line"><span class="comment">         *         / \              / \</span></span><br><span class="line"><span class="comment">         *        2   4 (t,ch)     2   4 (t)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        Entry&lt;K, V&gt; p = t.parent;</span><br><span class="line">        Entry&lt;K, V&gt; ch = t;</span><br><span class="line">        <span class="keyword">while</span>(p != <span class="keyword">null</span> &amp;&amp; ch == p.left)&#123;</span><br><span class="line">            ch = p;</span><br><span class="line">            p = p.parent;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="后继删除"><a href="#后继删除" class="headerlink" title="后继删除"></a>后继删除</h3><blockquote>
<p>后继删除就是查找大于当前值的最小值。</p>
</blockquote>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/14.jpg" class="" width="300">

<p>如图所示，如果采用后继删除法，会沿着 5 的右节点开始，一直向左子节点查询，直到元素 7。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询 t 节点的后继节点，也就是比 t 大的最小值</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *       5 (t)       5 (t)         5 (t)</span></span><br><span class="line"><span class="comment"> *      / \         / \           / \</span></span><br><span class="line"><span class="comment"> *     3   8  -&gt;   3  (8)   -&gt;   3   8</span></span><br><span class="line"><span class="comment"> *        / \         / \           / \</span></span><br><span class="line"><span class="comment"> *       7   9       7   9        (7)  9</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> &lt;K,V&gt; <span class="function">Entry&lt;K,V&gt; <span class="title">successor</span><span class="params">(Entry&lt;K,V&gt; t)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(t == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">// 如果 t 还右子树，那么顺着右子树找到大于 t 的最小值</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (t.right != <span class="keyword">null</span>) &#123;</span><br><span class="line">      Entry&lt;K, V&gt; r = t.right;</span><br><span class="line">      <span class="keyword">while</span>(r.left != <span class="keyword">null</span>)&#123;</span><br><span class="line">          r = r.left;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> r;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         *  这里是另外一种特殊的场景，也就是说，t 没有右子树，那就需要顺着 t 的父向上找</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         *             5              5</span></span><br><span class="line"><span class="comment">         *            / \            / \</span></span><br><span class="line"><span class="comment">         *       (p) 3   8   -&gt;    (3)  8</span></span><br><span class="line"><span class="comment">         *          / \            / \</span></span><br><span class="line"><span class="comment">         *  (t,ch) 2   4      (t) 2   4</span></span><br><span class="line"><span class="comment">         * ===========================================</span></span><br><span class="line"><span class="comment">         *            5            (p) 5            (5)</span></span><br><span class="line"><span class="comment">         *           / \              / \           / \</span></span><br><span class="line"><span class="comment">         *      (p) 3   8   -&gt;  (ch) 3   8  -&gt;     3   8</span></span><br><span class="line"><span class="comment">         *         / \              / \           / \</span></span><br><span class="line"><span class="comment">         *        2   4 (t,ch)     2   4 (t)     2   4 (t)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        Entry&lt;K, V&gt; p = t.parent;</span><br><span class="line">        Entry&lt;K, V&gt; ch = t;</span><br><span class="line">        <span class="keyword">while</span>(p != <span class="keyword">null</span> &amp;&amp; ch == p.right)&#123;</span><br><span class="line">            ch = p;</span><br><span class="line">            p = p.parent;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>无论是前驱删除还是后继删除，都会存在另外一种没有子节点的情况，也就是对应代码中的 <code>else</code>，当然了，如果是删除操作，是不会遇到这种情况的。我们看下图：</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/15.jpg" class="" width="200">

<p>如果查找元素 4 的前驱或者后继，我们发现它根本没有子节点。那么也就是说 4 没有前驱或者后继节点了吗？那肯定不是，毕竟图中的 3 跟 5 已经很明显的告诉你了，它们就是 4 的前驱及后继。</p>
<p>针对这种场景，我们需要变换个方向，向父节点方向查找就行了。如图：</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/16.jpg" class="" width="600">

<h2 id="删除开始"><a href="#删除开始" class="headerlink" title="删除开始"></a>删除开始</h2><blockquote>
<p>为了将删除操作简单化，我们还是以图例的方式，将涉及到的场景列出来，即使代码注释中已经存在了。</p>
</blockquote>
<h3 id="场景一-删除节点有两个子"><a href="#场景一-删除节点有两个子" class="headerlink" title="场景一 删除节点有两个子"></a>场景一 删除节点有两个子</h3><img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/17.jpg" class="" width="600">

<p>节点 5 是目标删除节点也就是图中的 p。首先，按照后继删除法，找到 p 的后继节点 7（图中的 s）。然后将 s 的 key、val 替换掉节点 p。同时 p 指向 s。再找到 p 的子节点 replacement。此时你可能会有疑问，如果此时的 p 有两个子节点呢？不可能，为什么？因为如果 p 有两个子节点，那么查找后继的过程中，p 的左节点一定是 s，而不是现在的 p 了。</p>
<p>找到 replacement 之后，我们需要把它的指向 p 的父节点，然后将 p 的父节点指向 replacement。最后断开 p 的双向指针，等系统回收。</p>
<p>最后我们发现 8、9 两个红色相连了，不要紧，我们这次只是删除。树的调平工作交给其他方法来做（这也是单一职责的一种体现）。问题来了，怎么判断是否需要调平衡呢？其实只需要知道 p 的颜色就行了。只有 p 为黑色时，才需要调平衡。</p>
<h3 id="场景二-删除节点有一个子"><a href="#场景二-删除节点有一个子" class="headerlink" title="场景二 删除节点有一个子"></a>场景二 删除节点有一个子</h3><blockquote>
<p>如果删除节点为根节点的话，那么直接让子节点成为新的根即可，然后进行调平。</p>
</blockquote>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/18.jpg" class="" width="600">

<p>当删除节点 p 时，它只有一个子 replacement，此时直接修改 replacement 的指向以及断开 p 即可。</p>
<h3 id="场景三-删除节点没有子"><a href="#场景三-删除节点没有子" class="headerlink" title="场景三 删除节点没有子"></a>场景三 删除节点没有子</h3><img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/19.jpg" class="" width="200">

<p>如果删除节点没有任何子节点时，说明它是叶子节点。首先需要根据它的颜色来判断是否需要调整。然后再将其与父的双向指针断开即可。</p>
<h3 id="场景四-删除节点是根"><a href="#场景四-删除节点是根" class="headerlink" title="场景四 删除节点是根"></a>场景四 删除节点是根</h3><p>如果删除的节点没有任何子，同时它又是根时，只需要把它置空即可。</p>
<p>有了以上的基础，我们再来看代码实现就简单明了了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 比如删除 5 元素，那么可以采用后继或者前驱的方式找到节点，替换 5 元素。</span></span><br><span class="line"><span class="comment"> * 这里按照 TreeMap 采用后继的方式删除，也就是说找到比 5 大的最小值，这里是 7。</span></span><br><span class="line"><span class="comment"> *     (p) 5                   7</span></span><br><span class="line"><span class="comment"> *        (黑)                (黑)</span></span><br><span class="line"><span class="comment"> *        / \                 / \</span></span><br><span class="line"><span class="comment"> *       3   9               3   9</span></span><br><span class="line"><span class="comment"> *     (黑)  (红)    -&gt;     (黑)  (红)</span></span><br><span class="line"><span class="comment"> *      /    / \            /    / \</span></span><br><span class="line"><span class="comment"> *     2    7   10         2    7   10</span></span><br><span class="line"><span class="comment"> *   (红)  (黑)  (黑)     (红)  (黑)  (黑)</span></span><br><span class="line"><span class="comment"> *          \                  (p)</span></span><br><span class="line"><span class="comment"> *           8                   \</span></span><br><span class="line"><span class="comment"> *          (红)                  8</span></span><br><span class="line"><span class="comment"> *                               (红)</span></span><br><span class="line"><span class="comment"> *                              (replacement)</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">deleteEntry</span><span class="params">(Entry&lt;K,V&gt; p)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 如果 p 有两个子节点</span></span><br><span class="line">    <span class="keyword">if</span> (p.left != <span class="keyword">null</span> &amp;&amp; p.right != <span class="keyword">null</span>) &#123;</span><br><span class="line">        Entry&lt;K, V&gt; s = successor(p);</span><br><span class="line">        p.k = s.k;</span><br><span class="line">        p.v = s.v;</span><br><span class="line">        p = s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Entry&lt;K, V&gt; replacement = p.left != <span class="keyword">null</span> ? p.left : p.right;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (replacement != <span class="keyword">null</span>)&#123;</span><br><span class="line">        <span class="comment">// 先修改父的指向</span></span><br><span class="line">        replacement.parent = p.parent;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         *     5 (p)</span></span><br><span class="line"><span class="comment">         *    /</span></span><br><span class="line"><span class="comment">         *   3 (replacement)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">if</span> (p.parent == <span class="keyword">null</span>)</span><br><span class="line">            root = replacement;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(p == p.parent.left)</span><br><span class="line">            p.parent.left = replacement;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            p.parent.right = replacement;</span><br><span class="line">        </span><br><span class="line">        p.left = p.right = p.parent = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">// 如果删除掉的节点是黑色的，那么就需要调整平衡了</span></span><br><span class="line">        <span class="keyword">if</span> (p.color = BLACK)</span><br><span class="line">            fixAfterDeletion(replacement);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 如果当前节点的父节点为 null，说明是根节点。因为既没有子又没有父，那肯定是根无误了</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (p.parent == <span class="keyword">null</span>)&#123;</span><br><span class="line">       root = <span class="keyword">null</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         *    5</span></span><br><span class="line"><span class="comment">         *   /</span></span><br><span class="line"><span class="comment">         *  2（p）</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">// 到这里说明替换的节点是叶子节点，直接删就对了。</span></span><br><span class="line">        <span class="keyword">if</span> (p.color == BLACK)</span><br><span class="line">            fixAfterDeletion(p);</span><br><span class="line">        <span class="comment">// 经过调整之后，判断当前 p 的父节点是否为 null</span></span><br><span class="line">        <span class="keyword">if</span> (p.parent != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (p == p.parent.left)</span><br><span class="line">                p.parent.left = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (p == p.parent.right)</span><br><span class="line">                p.parent.right = <span class="keyword">null</span>;</span><br><span class="line">            p.parent = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>读到这里，你可能发现红黑树的删除也不过如此，与 2-3-4 树的删除其实就是一回事（本文为了保证内容的连贯性，并没有做两者的等价关系）。如果你是这么想的，那么你可能太乐观了，因为重头戏马上就来了！</p>
<h2 id="树的调整"><a href="#树的调整" class="headerlink" title="树的调整"></a>树的调整</h2><blockquote>
<p>对目标节点删除之后，我们就需要根据情况来选择是否进行调整了。从删除的逻辑中我们可以得知只有删除的节点时黑色的时候才需要调整。</p>
</blockquote>
<h3 id="场景一-目标节点为根节点"><a href="#场景一-目标节点为根节点" class="headerlink" title="场景一 目标节点为根节点"></a>场景一 目标节点为根节点</h3><p>这个没什么好说的了，直接染黑就行了。</p>
<h3 id="场景二-目标节点为红色"><a href="#场景二-目标节点为红色" class="headerlink" title="场景二 目标节点为红色"></a>场景二 目标节点为红色</h3><img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/20.jpg" class="" width="600">

<p>上图是双节点的删除操作的最终状态，此时 x 节点并非根节点，同时它又是红色，我们从图中就能看出，只要将其染成黑色就行了。</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/21.jpg" class="" width="400">

<p>上图是针对于单节点删除的最终状态，我们只需要对 x 染黑即可完成树的平衡。</p>
<h3 id="场景三-兄弟节点不可借"><a href="#场景三-兄弟节点不可借" class="headerlink" title="场景三 兄弟节点不可借"></a>场景三 兄弟节点不可借</h3><img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/22.jpg" class="" width="400">

<p>以上红黑树，我们需要删除节点 4 作为本次场景的起点，注意：节点 4 被标记为 p 说明将来是需要被拿掉的，这点与 replacement 标记不同。</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/23.jpg" class="" width="1000">


<p>判断出 x 是左子节点还是右节点。上图 x 为左节点，也就是左倾树。我们根据 x 找到它的兄弟节点 sib。根据 sib 的颜色来判断 sib 是否是 x 的真正兄弟节点。什么意思？当 sib 为红色时，它并不是 x 的真正兄弟。图中的 6、8 对应的其实是 2-3-4 树中的三节点，也就是说 6、8 是处于同一级的。我们把它转成 2-3-4 树，你就明白了：</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/24.jpg" class="" width="400">

<p>从 2-3-4 树中，我们可以明显的看出，7 才是 x 的兄弟节点，8 并不是。所以对于红黑树而言，只有兄弟节点是黑色时，它才是自己的亲兄弟。</p>
<p>怎么才能找到 x 的亲兄弟呢？我们需要以 x 的父为中心进行左旋，在旋转之前，需要将当前 sib 染成黑色，x 的父节点染成红色。经过旋转之后就能拿到真正的 sib 了。</p>
<p>获取到真正兄弟之后，要判断它有几个子节点。注意这里有一个比较有意思的地方，那就是对于 <code>colorOf(x) == BLACK</code> 的判断，不知道你还记得 <code>colorOf(x)</code> 的实现吗？</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> &lt;K, V&gt; <span class="function"><span class="keyword">boolean</span> <span class="title">colorOf</span><span class="params">(Entry&lt;K, V&gt; p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (p == <span class="keyword">null</span> ? BLACK : p.color);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>有两种情况使得 <code>colorOf(x) == BLACK</code>，一个是为 null，一个是含有节点且为黑色。对于当前这个场景而言，sib 要不有两个子节点，要不没有任何子节点。这两种我们当成一回事。</p>
<p>那么有没有一种情况是一个节点为 null，一个节点为黑色呢？毕竟为 null 也是返回黑色？不可能！为什么？我们看 sib 是红色节点，它的父节点一定为黑色，所以 sib 是一个三节点元素。那么作为三节点元素，要不是以叶子形式存在的，要不是一定存在三个节点。不可能存在两个节点的情况。也就是说 sib 要不没有任何子节点，要不两个节点都在且为黑色。</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/25.jpg" class="" width="800">

<p>回到正题，拿到 sib 之后，由于没有任何可辅助 x 平衡的节点，那就只能让 sib 自损了，它的变成红色，谁让 x 失去一个黑色节点呢。sib 自损之后，就得让 x 跟 sib 的父去辅助平衡了。也就是说父节点必须是红色的才行，如果是黑色的，那还得向上找。不过不要紧，因为当前的父节点是经过左旋得到的，而左旋之前原有的 sib 是红色的。所以此时 x 的父一定是红色的。那把它染成黑色，树就平衡了。</p>
<p>那么可能还有一种场景，就是 sib 原本就是黑色的，那怎么办？我们看下图：</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/26.jpg" class="" width="500">

<p>为了打破平衡，我们删掉树中的节点 2，得到下图：</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/27.jpg" class="" width="500">

<p>其中 p 指向了节点 3。记住，p 是需要被删除的节点。由于 p 没有任何子节点，所以需要先进行调平，之后删除！</p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/28.jpg" class="" width="1200">

<p>此时 sib 为黑色，也就是 x 的亲兄弟。按照正常思路，需要将 sib 染红。此时向父的方向查找，直到找到红色的父节点。但是我们从图中可以看到，根本没有红色的父，不过也不要紧，每向上找到一级的父节点，我们就将当前父的兄弟节点染红。直到遇到红色的父节点或者根节点为止。</p>
<p>但是你可能会说，如果 sib 为红色怎么办？其实 sib 为红色时不就又回到第一种场景了？需要先左旋找到 x 的真正兄弟。也真是由于左旋，那么它们的父就会变成红色。只要将其染黑就解决了。</p>
<h4 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h4><blockquote>
<p>该场景是调整中最难的了，它不像常规那种子节点替换完成平衡，它只能向上查找。不过我们可以思考总结一下。当 x 所在节点树少一个黑色节点后，树就会失去平衡。所以只能看兄弟节点是否可以借出一个，如果不能借，那就让兄弟节点自损一个。此时两者等同，由于两者都少一个黑节点，那么就只能更让它们的父来补偿。也就是将红色的父变成黑色。</p>
<p>但是如果父也是黑色的，那就只能找父的兄弟借，如果不能借，那就把它的兄弟也变红。直到根或者找到红色的父节点。</p>
</blockquote>
<h3 id="场景四-兄弟节点可借"><a href="#场景四-兄弟节点可借" class="headerlink" title="场景四 兄弟节点可借"></a>场景四 兄弟节点可借</h3><p><strong>此时又分为两种情况，一种是存在单节点：</strong></p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/29.jpg" class="" width="800">

<p>首先找到 x 的兄弟节点，兄弟节点可借的情况说明它存在单红节点或者双红节点。对于单红节点也就是 2-3-4 树的三节点，需要先旋转一次。如图所示，定位到 sib 之后，旋转之前，需要将 sib 染红，sib 的子节点染黑。然后以 sib 为中心进行旋转，同时变更 sib 为 x 父的右节点。</p>
<p>将 x 的父节点颜色赋给 sib，x 的父及 sib 的子染黑。然后以 x 的父节点为中心旋转。变更 x 为 root，调整完成。</p>
<p><strong>另一种就是存在双红子节点：</strong></p>
<img src="/articles/2023/03/14/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%8B)%E5%88%A0%E9%99%A4/30.jpg" class="" width="800">

<p>当兄弟节点存在两个红色子节点时，也就是 2-3-4 树的四节点，那么相比三节点，只需要旋转一次就行了。如图所示，定位到 sib 之后，将 sib 的颜色设置为 x 的父节点颜色。将 x 的父节点及 sib 的右节点染红，然后以 x 的父节点左旋。最后将 x 指向 root，完成树的平衡。</p>
<p>整个树的调整逻辑就介绍完了，再来看代码就简单很多了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">fixAfterDeletion</span><span class="params">(Entry&lt;K, V&gt; x)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 如果 x 不为根以及 x 为黑色的时候才进入循环。毕竟 x 是根的话，直接染色就行了；如果是红色，删除根本不受影响</span></span><br><span class="line">    <span class="keyword">while</span> (x != root &amp;&amp; colorOf(x) == BLACK) &#123;</span><br><span class="line">        <span class="comment">// 如果是左倾树</span></span><br><span class="line">        <span class="keyword">if</span> (x == leftOf(parentOf(x)))&#123;</span><br><span class="line">            <span class="comment">// 获取 x 的兄弟节点</span></span><br><span class="line">            Entry&lt;K, V&gt; sib = rightOf(parentOf(x));</span><br><span class="line"></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * 找到 x 的真正兄弟节点</span></span><br><span class="line"><span class="comment">             *        10                     10</span></span><br><span class="line"><span class="comment">             *       (黑)                    (黑)</span></span><br><span class="line"><span class="comment">             *      /    \                  /    \</span></span><br><span class="line"><span class="comment">             *     6      15               8      15</span></span><br><span class="line"><span class="comment">             *    (黑)    (黑)      -&gt;    (黑)     (黑)</span></span><br><span class="line"><span class="comment">             *    / \     / \            /  \      /  \</span></span><br><span class="line"><span class="comment">             *   4   8   14  18         6    9    14   18</span></span><br><span class="line"><span class="comment">             * (黑) (红) (黑)  (黑)     (红)  (黑)  (黑)  (黑)</span></span><br><span class="line"><span class="comment">             *  x   sib                / \</span></span><br><span class="line"><span class="comment">             *      / \               4   7</span></span><br><span class="line"><span class="comment">             *     7   9              x  (黑)</span></span><br><span class="line"><span class="comment">             *    (黑) (黑)               sib</span></span><br><span class="line"><span class="comment">             *==============================================</span></span><br><span class="line"><span class="comment">             * 由于红黑树本质是 2-3-4 树，上图中，在红黑树看来，8 是 x 的兄弟节点，实际上并非如此：</span></span><br><span class="line"><span class="comment">             *</span></span><br><span class="line"><span class="comment">             *             10</span></span><br><span class="line"><span class="comment">             *         /       \</span></span><br><span class="line"><span class="comment">             *       6  8      15</span></span><br><span class="line"><span class="comment">             *       / | \    /  \</span></span><br><span class="line"><span class="comment">             *      4  7  9  14  18</span></span><br><span class="line"><span class="comment">             *</span></span><br><span class="line"><span class="comment">             * 还原到 2-3-4 树之后发现 7 才是 4 的兄弟节点，所以在红黑树看来，如果当前节点是黑色，</span></span><br><span class="line"><span class="comment">             * 兄弟节点是红色时，由于它们 并非处于同一级，所以此时的兄弟节点并非真正的兄弟节点，所以</span></span><br><span class="line"><span class="comment">             * 需要旋转得到</span></span><br><span class="line"><span class="comment">             *</span></span><br><span class="line"><span class="comment">             *</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="keyword">if</span> (colorOf(sib) == RED)&#123;</span><br><span class="line">                setColor(sib, BLACK);</span><br><span class="line">                setColor(parentOf(x), RED);</span><br><span class="line">                rotateLeft(parentOf(x));</span><br><span class="line">                <span class="comment">// 获取真正的兄弟节点</span></span><br><span class="line">                sib = rightOf(parentOf(x));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果兄弟节点没有子节点，也就是兄弟节点无法辅助平衡</span></span><br><span class="line">            <span class="keyword">if</span>(colorOf(leftOf(sib)) == BLACK &amp;&amp; colorOf(rightOf(sib)) == BLACK)&#123;</span><br><span class="line">                <span class="comment">// 将兄弟节点染成红色，然后向上递归查找直到父亲节点的颜色为红色时，停止。然后将其染黑，完成平衡</span></span><br><span class="line">                setColor(sib, RED);</span><br><span class="line">                x = parentOf(x);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                 * 兄弟节点有子节点，也就是说兄弟节点可以辅助平衡</span></span><br><span class="line"><span class="comment">                 *            10                          10</span></span><br><span class="line"><span class="comment">                 *           (黑)                         (黑)</span></span><br><span class="line"><span class="comment">                 *          /    \                       /    \</span></span><br><span class="line"><span class="comment">                 *        8      15                     8      15</span></span><br><span class="line"><span class="comment">                 *       (黑)     (黑)                 (黑)     (黑)</span></span><br><span class="line"><span class="comment">                 *       /  \      /  \               /  \      /  \</span></span><br><span class="line"><span class="comment">                 *      5    9    14   18            5    9    14   18</span></span><br><span class="line"><span class="comment">                 *     (红)  (黑)  (黑)  (黑)    -&gt;  (红)  (黑)  (黑)  (黑)</span></span><br><span class="line"><span class="comment">                 *     / \                          / \</span></span><br><span class="line"><span class="comment">                 *    4   7                        4   6</span></span><br><span class="line"><span class="comment">                 *    x  (黑)                      x   (黑)</span></span><br><span class="line"><span class="comment">                 *       sib                           sib</span></span><br><span class="line"><span class="comment">                 *        /                              \</span></span><br><span class="line"><span class="comment">                 *       6                                7</span></span><br><span class="line"><span class="comment">                 *      (红)                              (红)</span></span><br><span class="line"><span class="comment">                 *</span></span><br><span class="line"><span class="comment">                 *</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">                <span class="comment">// 如果右节点为空，那就说明是左节点，那么就需要单独转一次，如果不为空</span></span><br><span class="line">                <span class="comment">// 说明是左倾树或者是四节点树，这样整体一次左旋转就行了</span></span><br><span class="line">                <span class="keyword">if</span> (colorOf(rightOf(sib)) == BLACK)&#123;</span><br><span class="line">                    <span class="comment">// 先染色，避免红红相连</span></span><br><span class="line">                    setColor(leftOf(sib), BLACK);</span><br><span class="line">                    <span class="comment">// 既然子节点已经是黑色了，那么 sib 就需要染成红色，避免多一个黑节点</span></span><br><span class="line">                    setColor(sib, RED);</span><br><span class="line">                    rotateRight(sib);</span><br><span class="line">                    sib = rightOf(parentOf(x));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                 *======================3 节点情况======================</span></span><br><span class="line"><span class="comment">                 *               10                             10</span></span><br><span class="line"><span class="comment">                 *              (黑)                            (黑)</span></span><br><span class="line"><span class="comment">                 *             /    \                          /    \</span></span><br><span class="line"><span class="comment">                 *            8      15                       8      15</span></span><br><span class="line"><span class="comment">                 *          (黑)      (黑)                    (黑)     (黑)</span></span><br><span class="line"><span class="comment">                 *          /  \      /  \                   /  \     /  \</span></span><br><span class="line"><span class="comment">                 *         5    9    14   18                6    9    14   18</span></span><br><span class="line"><span class="comment">                 *        (红)  (黑)  (黑)  (黑)    -&gt;      (红)  (黑)  (黑)  (黑)</span></span><br><span class="line"><span class="comment">                 *        / \                              / \</span></span><br><span class="line"><span class="comment">                 *       4   6                            5   7</span></span><br><span class="line"><span class="comment">                 *       x   (黑)                        (黑)  (黑)</span></span><br><span class="line"><span class="comment">                 *           sib                         /</span></span><br><span class="line"><span class="comment">                 *             \                        4</span></span><br><span class="line"><span class="comment">                 *              7                       x</span></span><br><span class="line"><span class="comment">                 *             (红)</span></span><br><span class="line"><span class="comment">                 *======================4 节点情况======================</span></span><br><span class="line"><span class="comment">                 *               14                            14</span></span><br><span class="line"><span class="comment">                 *              (黑)                           (黑)</span></span><br><span class="line"><span class="comment">                 *            /      \                       /      \</span></span><br><span class="line"><span class="comment">                 *           10      15                     10      15</span></span><br><span class="line"><span class="comment">                 *          (黑)      (黑)                 (黑)      (黑)</span></span><br><span class="line"><span class="comment">                 *          /  \      /  \                /  \      /  \</span></span><br><span class="line"><span class="comment">                 *         5    12   14   18             8    12   14   18</span></span><br><span class="line"><span class="comment">                 *        (红)  (黑)  (黑)  (黑)        (红)  (黑)  (黑)  (黑)</span></span><br><span class="line"><span class="comment">                 *        / \                   -&gt;     / \</span></span><br><span class="line"><span class="comment">                 *       4   8                        5   9</span></span><br><span class="line"><span class="comment">                 *       x  (黑)                     (黑)  (黑)</span></span><br><span class="line"><span class="comment">                 *          sib                      / \</span></span><br><span class="line"><span class="comment">                 *          / \                     4   7</span></span><br><span class="line"><span class="comment">                 *         7   9                    x   (红)</span></span><br><span class="line"><span class="comment">                 *       (红)  (红)</span></span><br><span class="line"><span class="comment">                 *</span></span><br><span class="line"><span class="comment">                 * 如果是 4 节点情况，只需要左旋一次就完成了</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">                setColor(sib, colorOf(parentOf(x)));</span><br><span class="line">                setColor(parentOf(x), BLACK);</span><br><span class="line">                setColor(rightOf(sib), BLACK);</span><br><span class="line">                rotateLeft(parentOf(x));</span><br><span class="line">                x = root;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 右倾树的处理</span></span><br><span class="line">            Entry&lt;K, V&gt; sib = leftOf(parentOf(x));</span><br><span class="line"></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * 如果 x 的兄弟节点 sib 是红色，说明 sib 并不是 x 真正兄弟节点（兄弟节点是在同一级的）</span></span><br><span class="line"><span class="comment">             *        10                     10</span></span><br><span class="line"><span class="comment">             *       (黑)                    (黑)</span></span><br><span class="line"><span class="comment">             *      /    \                  /    \</span></span><br><span class="line"><span class="comment">             *     6      16               8      14</span></span><br><span class="line"><span class="comment">             *    (黑)    (黑)      -&gt;    (黑)     (黑)</span></span><br><span class="line"><span class="comment">             *    / \     / \            /  \      /  \</span></span><br><span class="line"><span class="comment">             *   4   8   14  18         6    9    13   16</span></span><br><span class="line"><span class="comment">             * (黑) (黑) (红)  (黑)     (黑)  (黑)  (黑)  (红)</span></span><br><span class="line"><span class="comment">             *          sib    x                        / \</span></span><br><span class="line"><span class="comment">             *          / \                            15  18</span></span><br><span class="line"><span class="comment">             *         13  15                         (黑)  (黑)</span></span><br><span class="line"><span class="comment">             *        (黑) (黑)                        sib    x</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="keyword">if</span> (colorOf(sib) == RED) &#123;</span><br><span class="line">                setColor(sib, BLACK);</span><br><span class="line">                setColor(parentOf(x), RED);</span><br><span class="line">                rotateRight(parentOf(x));</span><br><span class="line">                <span class="comment">// 此时的 sib 才是 x 的真正兄弟节点</span></span><br><span class="line">                sib = leftOf(parentOf(x));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果兄弟节点没有子节点，无法辅助平衡，那就向上递归查找它们红色的父节点，找到之后，将颜色变为黑色</span></span><br><span class="line">            <span class="keyword">if</span> (colorOf(leftOf(sib)) == BLACK &amp;&amp; colorOf(rightOf(sib)) == BLACK) &#123;</span><br><span class="line">                setColor(sib, RED);</span><br><span class="line">                x = parentOf(x);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 如果兄弟节点有子节点，此时要判断是一个子还是两个子（也就是涉及到几次旋转）</span></span><br><span class="line">                <span class="comment">// 只要有一个子为空，就说明是单子节点</span></span><br><span class="line">                <span class="keyword">if</span> (colorOf(leftOf(sib)) == BLACK) &#123;</span><br><span class="line">                    <span class="comment">/*</span></span><br><span class="line"><span class="comment">                     * 如果是单子节点，那么就先需要一次左旋或者右旋</span></span><br><span class="line"><span class="comment">                     *        10                          10</span></span><br><span class="line"><span class="comment">                     *       (黑)                         (黑)</span></span><br><span class="line"><span class="comment">                     *      /    \                       /    \</span></span><br><span class="line"><span class="comment">                     *      8      14                   8      14</span></span><br><span class="line"><span class="comment">                     *    (黑)     (黑)                (黑)     (黑)</span></span><br><span class="line"><span class="comment">                     *   /  \      /  \               /  \      /  \</span></span><br><span class="line"><span class="comment">                     *  6    9    13   17            6    9    13   17</span></span><br><span class="line"><span class="comment">                     * (黑)  (黑)  (黑)  (红)   -&gt;   (黑)  (黑)  (黑)  (红)</span></span><br><span class="line"><span class="comment">                     *                  / \                          / \</span></span><br><span class="line"><span class="comment">                     *                 15  18                       16  18</span></span><br><span class="line"><span class="comment">                     *                (黑)  (黑)                    (黑)  (黑)</span></span><br><span class="line"><span class="comment">                     *                sib    x                      sib   x</span></span><br><span class="line"><span class="comment">                     *                  \                            /</span></span><br><span class="line"><span class="comment">                     *                  16                          15</span></span><br><span class="line"><span class="comment">                     *                 (红)                        (红)</span></span><br><span class="line"><span class="comment">                     */</span></span><br><span class="line">                    setColor(rightOf(sib), BLACK);</span><br><span class="line">                    setColor(sib, RED);</span><br><span class="line">                    rotateLeft(sib);</span><br><span class="line">                    sib = leftOf(parentOf(x));</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                 * 此时，无论是单节点情况还是双子节点情况，都需要左一次旋转</span></span><br><span class="line"><span class="comment">                 *</span></span><br><span class="line"><span class="comment">                 *===================单子节点情况，接上图===================</span></span><br><span class="line"><span class="comment">                 *        10                           10</span></span><br><span class="line"><span class="comment">                 *        (黑)                         (黑)</span></span><br><span class="line"><span class="comment">                 *       /    \                       /    \</span></span><br><span class="line"><span class="comment">                 *      8      14                    8      14</span></span><br><span class="line"><span class="comment">                 *     (黑)     (黑)                (黑)     (黑)</span></span><br><span class="line"><span class="comment">                 *    /  \      /  \               /  \      /  \</span></span><br><span class="line"><span class="comment">                 *   6    9    13   17            6    9    13   15</span></span><br><span class="line"><span class="comment">                 *  (黑)  (黑)  (黑)  (红)        (黑)  (黑)  (黑)  (红)</span></span><br><span class="line"><span class="comment">                 *                  / \     -&gt;                    sib</span></span><br><span class="line"><span class="comment">                 *                 16  18                          / \</span></span><br><span class="line"><span class="comment">                 *                (黑)  (黑)                      16  17</span></span><br><span class="line"><span class="comment">                 *                sib   x                       (黑) (黑)</span></span><br><span class="line"><span class="comment">                 *                  /                                  \</span></span><br><span class="line"><span class="comment">                 *                 15                                  18</span></span><br><span class="line"><span class="comment">                 *                 (红)                                (黑)</span></span><br><span class="line"><span class="comment">                 *                                                      x</span></span><br><span class="line"><span class="comment">                 *======================双节点情况=======================</span></span><br><span class="line"><span class="comment">                 *</span></span><br><span class="line"><span class="comment">                 *         10                           10</span></span><br><span class="line"><span class="comment">                 *        (黑)                          (黑)</span></span><br><span class="line"><span class="comment">                 *       /    \                        /    \</span></span><br><span class="line"><span class="comment">                 *      8      12                     8      12</span></span><br><span class="line"><span class="comment">                 *     (黑)     (黑)                 (黑)     (黑)</span></span><br><span class="line"><span class="comment">                 *    /  \      /  \                /  \      /  \</span></span><br><span class="line"><span class="comment">                 *   6    9    11   17             6    9    11   15</span></span><br><span class="line"><span class="comment">                 *  (黑)  (黑)  (黑) (红)   -&gt;     (黑)  (黑)  (黑)  (红)</span></span><br><span class="line"><span class="comment">                 *                   / \                           sib</span></span><br><span class="line"><span class="comment">                 *                  15  18                         / \</span></span><br><span class="line"><span class="comment">                 *                 (黑)  (黑)                      14  17</span></span><br><span class="line"><span class="comment">                 *                 sib   x                       (黑)  (黑)</span></span><br><span class="line"><span class="comment">                 *                 / \                                 / \</span></span><br><span class="line"><span class="comment">                 *                14  16                             16  18</span></span><br><span class="line"><span class="comment">                 *               (红) (红)                           (红) (黑)</span></span><br><span class="line"><span class="comment">                 *                                                        x</span></span><br><span class="line"><span class="comment">                 *</span></span><br><span class="line"><span class="comment">                 *</span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line">                setColor(sib, colorOf(parentOf(x)));</span><br><span class="line">                setColor(parentOf(x), BLACK);</span><br><span class="line">                setColor(leftOf(sib), BLACK);</span><br><span class="line">                rotateRight(parentOf(x));</span><br><span class="line">                x = root;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 别忘了最后一步的染黑</span></span><br><span class="line">    setColor(x, BLACK);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="尾声"><a href="#尾声" class="headerlink" title="尾声"></a>尾声</h1><p>至此，整个红黑树就介绍完了。希望读完红黑树三篇文章之后，你能彻底掌握红黑树！</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/articles/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" rel="tag"># 数据结构与算法</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/articles/2023/03/09/dsaa/%E4%BB%8ETreeMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90%E7%BA%A2%E9%BB%91%E6%A0%91(%E4%B8%AD)%E6%8F%92%E5%85%A5/" rel="prev" title="从 TreeMap 源码剖析红黑树（中）插入">
      <i class="fa fa-chevron-left"></i> 从 TreeMap 源码剖析红黑树（中）插入
    </a></div>
      <div class="post-nav-item">
    <a href="/articles/2023/03/23/java/Java%E9%94%81%E6%9C%BA%E5%88%B6%E4%B9%8BSynchronized%E5%AE%9E%E7%8E%B0(%E4%B8%8A)/" rel="next" title="Java 锁机制之 Synchronized 实现（上）">
      Java 锁机制之 Synchronized 实现（上） <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BC%95%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">引言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-3-4-%E6%A0%91%E7%9A%84%E5%88%A0%E9%99%A4"><span class="nav-number">2.</span> <span class="nav-text">2-3-4 树的删除</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E8%8A%82%E7%82%B9%E7%9A%84%E5%88%A0%E9%99%A4"><span class="nav-number">2.1.</span> <span class="nav-text">三节点的删除</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B%E8%8A%82%E7%82%B9%E5%88%A0%E9%99%A4"><span class="nav-number">2.2.</span> <span class="nav-text">四节点删除</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E8%8A%82%E7%82%B9%E5%88%A0%E9%99%A4"><span class="nav-number">2.3.</span> <span class="nav-text">二节点删除</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">2.4.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BA%A2%E9%BB%91%E6%A0%91%E7%9A%84%E5%88%A0%E9%99%A4"><span class="nav-number">3.</span> <span class="nav-text">红黑树的删除</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E6%96%B9%E5%BC%8F"><span class="nav-number">3.1.</span> <span class="nav-text">删除方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E9%A9%B1%E5%88%A0%E9%99%A4"><span class="nav-number">3.1.1.</span> <span class="nav-text">前驱删除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8E%E7%BB%A7%E5%88%A0%E9%99%A4"><span class="nav-number">3.1.2.</span> <span class="nav-text">后继删除</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E5%BC%80%E5%A7%8B"><span class="nav-number">3.2.</span> <span class="nav-text">删除开始</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF%E4%B8%80-%E5%88%A0%E9%99%A4%E8%8A%82%E7%82%B9%E6%9C%89%E4%B8%A4%E4%B8%AA%E5%AD%90"><span class="nav-number">3.2.1.</span> <span class="nav-text">场景一 删除节点有两个子</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF%E4%BA%8C-%E5%88%A0%E9%99%A4%E8%8A%82%E7%82%B9%E6%9C%89%E4%B8%80%E4%B8%AA%E5%AD%90"><span class="nav-number">3.2.2.</span> <span class="nav-text">场景二 删除节点有一个子</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF%E4%B8%89-%E5%88%A0%E9%99%A4%E8%8A%82%E7%82%B9%E6%B2%A1%E6%9C%89%E5%AD%90"><span class="nav-number">3.2.3.</span> <span class="nav-text">场景三 删除节点没有子</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF%E5%9B%9B-%E5%88%A0%E9%99%A4%E8%8A%82%E7%82%B9%E6%98%AF%E6%A0%B9"><span class="nav-number">3.2.4.</span> <span class="nav-text">场景四 删除节点是根</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%91%E7%9A%84%E8%B0%83%E6%95%B4"><span class="nav-number">3.3.</span> <span class="nav-text">树的调整</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF%E4%B8%80-%E7%9B%AE%E6%A0%87%E8%8A%82%E7%82%B9%E4%B8%BA%E6%A0%B9%E8%8A%82%E7%82%B9"><span class="nav-number">3.3.1.</span> <span class="nav-text">场景一 目标节点为根节点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF%E4%BA%8C-%E7%9B%AE%E6%A0%87%E8%8A%82%E7%82%B9%E4%B8%BA%E7%BA%A2%E8%89%B2"><span class="nav-number">3.3.2.</span> <span class="nav-text">场景二 目标节点为红色</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF%E4%B8%89-%E5%85%84%E5%BC%9F%E8%8A%82%E7%82%B9%E4%B8%8D%E5%8F%AF%E5%80%9F"><span class="nav-number">3.3.3.</span> <span class="nav-text">场景三 兄弟节点不可借</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-1"><span class="nav-number">3.3.3.1.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF%E5%9B%9B-%E5%85%84%E5%BC%9F%E8%8A%82%E7%82%B9%E5%8F%AF%E5%80%9F"><span class="nav-number">3.3.4.</span> <span class="nav-text">场景四 兄弟节点可借</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B0%BE%E5%A3%B0"><span class="nav-number">4.</span> <span class="nav-text">尾声</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Tubetrue01"
      src="/articles/img/head.PNG">
  <p class="site-author-name" itemprop="name">Tubetrue01</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/articles/archives/">
        
          <span class="site-state-item-count">67</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/articles/tags/">
          
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Tubetrue01" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Tubetrue01" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tubetrue01</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/articles/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0/pjax.min.js"></script>
  <script src="/articles/lib/velocity/velocity.min.js"></script>
  <script src="/articles/lib/velocity/velocity.ui.min.js"></script>

<script src="/articles/js/utils.js"></script>

<script src="/articles/js/motion.js"></script>


<script src="/articles/js/schemes/pisces.js"></script>


<script src="/articles/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  















    <div id="pjax">
  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'b78837f065395b7c4761',
      clientSecret: '58c95c03db39e7430738d663bfc8337a5c8e1e80',
      repo        : 'articles',
      owner       : 'Tubetrue01',
      admin       : ['Tubetrue01'],
      id          : '15b2bf0b5cfe99b2a2232c92507c340e',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

    </div>
</body>
</html>
